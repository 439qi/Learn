# Docker

<!-- better merge this into note_Unix.md -->
## 难题与虚拟机

软件开发的一个问题是环境配置，只有操作系统的设置、各种库和组件配置正确时才能确保软件正常运行  

虚拟机通过在操作系统里模拟另一个操作系统，以还原软件的原始环境  
该方案的问题在于：

1. 资源占用  
    相对于软件本身占用的资源，虚拟机模拟底层硬件以及完整的操作系统需要占用额外的资源且往往大于软件所需的资源
2. 冗余步骤  
    虚拟机模拟完整的操作系统，某些步骤对于模拟软件运行环境是多余的，如用户登录等
3. 启动开销  
    同上

## Linux 容器

Linux 发展出了另一种进程级的虚拟化技术 - **Linux 容器**(Linux Containers, LXC)  

Linux 容器对进程进行隔离，对于容器内的进程，其所获取的资源均为虚拟的

1. 资源占用  
    仅占用软件所需的资源
2. 体积  
    容器只需要包含用到的组件
3. 启动开销  
    同上

## Docker 说明

Docker 是对 Linux 容器的封装，并提供简单易用的接口  
> 自1.20版本开始 docker 已经抛弃 Linux 容器，使用 Namespaces 和 Control groups  

Docker 将软件和其依赖打包在一个 image 文件里，运行时生成一个虚拟容器以模拟环境  
该容器实例本身也是一个文件，称为容器文件

## image 文件，容器文件和 Dockerfile 文件

image 是二进制文件，image 文件在不同机器上是通用的  

容器文件在容器停止后也不会删除，必须手动删除  

Dockerfile 是文本文件，Docker 根据该文件生成二进制的 image 文件
